# 🚀 AutoPaste v2.0 升级指南

## 📊 版本对比

### v1.0 → v2.0 主要改进

| 特性 | v1.0 | v2.0 |
|------|------|------|
| **核心技术** | pydirectinput + pyautogui | 纯 Windows API (ctypes + SendInput) |
| **Unicode 支持** | ❌ 仅英文 | ✅ 支持中文等多语言 |
| **依赖库** | 5个（pyautogui, pyperclip, keyboard, pydirectinput, pywin32） | 2个（keyboard, pywin32） |
| **热键** | Ctrl+Alt+J | Ctrl+Alt+P |
| **可配置性** | ❌ 硬编码 | ✅ 运行时可调整 |
| **输入延迟** | 固定 100ms | 可调整 1-100ms（默认5ms） |
| **等待时间** | 固定 0.5s | 可调整 1-10s（默认2s） |
| **设置菜单** | ❌ 无 | ✅ 按 S 键打开 |
| **进度显示** | ❌ 无 | ✅ 每50字符显示进度 |
| **文件大小** | ~15MB | ~12MB（预估） |

## 🎯 升级策略

### 方案一：替换升级（已选择）

```
项目结构：
autopaste/
├── autopaste.py          # v2.0 主程序
├── build.py              # v2.0 打包脚本
├── legacy/               # v1.0 备份
│   ├── autopaste.py      # v1.0 主程序
│   ├── build.py          # v1.0 打包脚本
│   └── README.md         # v1.0 说明
├── README.md             # 更新的文档
├── CHANGELOG.md          # 版本变更记录
└── ...其他文件
```

## 📝 升级步骤

### 步骤 1：备份 v1.0
```bash
# 创建 legacy 文件夹
mkdir legacy

# 移动 v1.0 文件
move autopaste.py legacy/
move build.py legacy/
```

### 步骤 2：复制 v2.0 文件
```bash
# 从 autokey-claude4-5 复制到主目录
copy ..\autokey-claude4-5\autopaste.py .
copy ..\autokey-claude4-5\build.py .
```

### 步骤 3：更新文档
- 更新 README.md（添加 v2.0 特性说明）
- 创建 CHANGELOG.md（记录版本变更）
- 更新 RELEASE_NOTES.txt（v2.0 发布说明）

### 步骤 4：提交到 Git
```bash
git add .
git commit -m "Upgrade to v2.0: Unicode support and improved architecture"
git push
```

### 步骤 5：创建 Release
1. 打包 v2.0：`python build.py`
2. 访问：https://github.com/buptanswer/autopaste/releases/new
3. Tag: `v2.0.0`
4. 上传新的 exe 文件

## 🔄 迁移指南（用户）

### 从 v1.0 迁移到 v2.0

**主要变化：**
1. **热键变更**：`Ctrl+Alt+J` → `Ctrl+Alt+P`
2. **新增功能**：
   - 支持中文输入
   - 可调整输入速度（按 S 键）
   - 显示输入进度

**使用方法：**
```
1. 下载新版本 exe
2. 以管理员身份运行
3. 复制内容到剪贴板
4. 按 Ctrl+Alt+P 触发输入（注意热键变化）
5. 按 S 键可以调整设置
6. 按 ESC 退出
```

## 📋 v2.0 新特性详解

### 1. Unicode 支持
```python
# v1.0：只能输入英文
text = "Hello123!@#"

# v2.0：支持多语言
text = "你好世界！Hello123!@#"
```

### 2. 可配置设置
```
运行时按 S 键打开设置菜单：
1. 修改输入延迟（1-100ms）
2. 修改等待时间（1-10s）
```

### 3. 进度显示
```
输入长文本时，每50个字符显示一次进度：
  进度: 50/200 字符
  进度: 100/200 字符
  进度: 150/200 字符
```

### 4. 更好的错误处理
- 剪贴板读取失败自动重试（最多3次）
- 字符发送失败会显示警告
- 清理资源时防止重复操作

## ⚠️ 注意事项

### 兼容性
- ✅ Windows 7/8/10/11
- ✅ 需要管理员权限
- ✅ 依赖更少，更稳定

### 已知限制
- 仍然只支持标准键盘布局的特殊符号
- 输入速度受系统性能影响

### 建议
- 首次使用建议保留 v1.0 作为备份
- 如果 v2.0 有问题，可以回退到 legacy/ 中的 v1.0

## 🐛 问题排查

### Q: v2.0 无法输入中文？
A: 确保：
- 以管理员身份运行
- 目标程序支持 Unicode 输入
- 输入框已获得焦点

### Q: 想回退到 v1.0？
A: 
```bash
# 从 legacy 文件夹复制回来
copy legacy\autopaste.py .
copy legacy\build.py .
python build.py
```

### Q: 两个版本可以共存吗？
A: 可以，但需要重命名 exe 文件避免冲突：
- v1.0: `密码自动输入工具_v1.exe`
- v2.0: `密码自动输入工具_v2.exe`

## 📞 获取帮助

- 查看 [CHANGELOG.md](CHANGELOG.md) 了解详细变更
- 提交 [Issue](https://github.com/buptanswer/autopaste/issues)
- 查看 [README.md](README.md) 获取使用说明

---

**升级时间**: 2025-11-27  
**当前版本**: v2.0.0  
**上一版本**: v1.0.0